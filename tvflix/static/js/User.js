// Generated by CoffeeScript 1.9.1
(function() {
  "use strict";

  /*
    Represent the User in the application
   */
  (function($) {
    var User, root;
    User = (function() {
      function User(name, apikey) {
        this.name = name;
        this.apikey = apikey;
      }

      User.prototype.saveLocalStorage = function() {
        return localStorage.setItem('User', JSON.stringify(this));
      };

      User.prototype.setInfo = function(name, apikey) {
        this.name = name;
        this.apikey = apikey;
        this.saveLocalStorage();
        return $(this).trigger('user.login');
      };

      User.prototype.isValid = function() {
        return typeof this.name !== "undefined" && typeof this.apikey !== 'undefined';
      };

      User.prototype.clearInfo = function() {
        delete this.apikey;
        delete this.name;
        localStorage.removeItem('User');
        return $(this).trigger('user.logout');
      };

      User.prototype.sendUserRequest = function(url, method, data) {
        return $.ajax({
          url: url,
          dataType: 'json',
          type: method,
          data: data ? JSON.stringify(data) : void 0,
          headers: {
            'Content-Type': 'application/json',
            'apikey': this.apikey
          }
        });
      };

      User.fromLocalStorage = function() {
        var localObject, localUser;
        localUser = localStorage.getItem('User');
        if (localUser) {
          localObject = new User();
          $.extend(localObject, JSON.parse(localUser));
          return localObject;
        }
        return new User();
      };

      User.currentUser = null;

      User.getCurrentUser = function() {
        var ref;
        return (ref = this.currentUser) != null ? ref : this.currentUser = User.fromLocalStorage();
      };

      return User;

    })();
    root = typeof window !== "undefined" && window !== null ? window : this;
    return root.User = User;
  })(jQuery);

}).call(this);

//# sourceMappingURL=User.js.map
