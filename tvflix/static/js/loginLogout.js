// Generated by CoffeeScript 1.9.1
(function() {
  "use strict";
  var admin, apikey, username;

  username = localStorage.getItem("username");

  apikey = localStorage.getItem("apikey");

  admin = localStorage.getItem("admin");

  (function($) {

    /*
      Activate tooltips on links
     */
    var getUserInfo, handleLogout, setLogout;
    $("a[data-toggle='tooltip']").tooltip();

    /*
      FUNCTION BLOCK
     */
    setLogout = function() {
      return $('#userLoginButton').html("Logout").attr('data-logout', true);
    };

    /*
      Retrieve the user info
     */
    getUserInfo = function() {
      username = $("#username").val();
      apikey = $("#apikey").val();
      admin = $("#adminCheck").is(":checked");
      if (!username || !apikey) {
        $("#emptyAlert").fadeIn();
        return false;
      } else {
        $("#emptyAlert").fadeOut();
      }
      localStorage.setItem("username", username);
      localStorage.setItem('apikey', apikey);
      localStorage.setItem('admin', admin);
      return true;
    };

    /*
      Remove data from the localstorage and logout the user
     */
    handleLogout = function() {
      username = null;
      apikey = null;
      localStorage.removeItem("username");
      localStorage.removeItem("apikey");
      localStorage.removeItem("admin");
      return $(this).html("Login").removeAttr('data-logout');
    };

    /*
      check if already logged in with LocalStorage
     */
    if (username && apikey) {
      $("#username").val(username);
      $("#apikey").val(apikey);
      if (admin) {
        $("#adminCheck").prop('checked', true);
      }
      setLogout();
    }

    /*
      BUTTON MANAGEMENT
     */
    $("#loginButton").click(function(e) {
      e.preventDefault();
      if (getUserInfo()) {
        $("#loginModal").modal("hide");
        return setLogout();
      }
    });
    return $('#userLoginButton').click(function(e) {
      e.preventDefault();
      if ($(this).attr("data-logout")) {
        return handleLogout.call(this);
      } else {
        return $("#loginModal").modal("show");
      }
    });
  })(jQuery);

}).call(this);

//# sourceMappingURL=loginLogout.js.map
