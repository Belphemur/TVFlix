// Generated by CoffeeScript 1.9.1
(function() {
  "use strict";
  (function($) {
    var $body, handleSearchRequest, handleSelectionShow, setShowInformations, toggleLoading;
    $body = $('body');
    toggleLoading = function() {
      if ($body.hasClass('loading')) {
        return $body.removeClass('loading');
      } else {
        return $body.addClass('loading');
      }
    };
    handleSearchRequest = function(request, responseCallback) {
      var query;
      query = request.term;
      return $.ajax({
        type: "GET",
        data: {
          query: query
        },
        url: "/tvflix/search/shows",
        dataType: "json",
        global: false
      }).success(function(json) {
        var responseArray;
        responseArray = [];
        json._embedded.forEach(function(show) {
          var toAdd;
          toAdd = {};
          $.extend(toAdd, show, {
            showLabel: show.label,
            label: show.title,
            value: show.label
          });
          return responseArray.push(toAdd);
        });
        return responseCallback(responseArray);
      }).fail(function(jqXHR) {
        if (jqXHR.status !== 404) {
          return console.error(jqXHR);
        }
      });
    };
    setShowInformations = function(item) {
      $('#startYear').text(item.start_year);
      $('#showTitle').text(item.title);
      $('#endYear').text(item.end_year);
      $('#channel').text(item.channel);
      return $('#summary').text(item.summary);
    };
    handleSelectionShow = function(event, ui) {
      toggleLoading();
      $('#placeholder').hide();
      setShowInformations(ui.item);
      $('#showContainer').fadeIn();
      return setTimeout(toggleLoading, 500);
    };
    $("input[data-toggle='tooltip'][type='search']").tooltip();
    return $('#searchShows').autocomplete({
      source: handleSearchRequest,
      minLength: 2,
      select: handleSelectionShow
    });
  })(jQuery);

}).call(this);

//# sourceMappingURL=search.js.map
